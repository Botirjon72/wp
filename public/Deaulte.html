<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Cyberpunk Dashboard</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;700&display=swap');

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      min-height: 100vh;
      font-family: 'Rajdhani', sans-serif;
      background: #000;
      display: flex;
      flex-direction: column;
    }

    body::before {
      content: "";
      position: fixed;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(white 1px, transparent 1px),
                  radial-gradient(white 1px, transparent 1px);
      background-position: 0 0, 50px 50px;
      background-size: 100px 100px;
      animation: stars 100s linear infinite;
      z-index: 0;
      opacity: 0.2;
    }

    @keyframes stars {
      from { transform: translateY(0); }
      to   { transform: translateY(1000px); }
    }

    main {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      padding-bottom: 100px;
      position: relative;
      z-index: 2;
    }


    .user-info {
      display: flex;
      margin: 20px;
      justify-content: space-between;
      flex-wrap: wrap;
      color: #fff;
      gap: 10px;
      padding-bottom: 15px;
      border-bottom: 1px solid #0ff;
      align-items: center;
    }

    .user-profile {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .avatar {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      border: 2px solid #0ff;
    }

    .user-info h3 {
      color: #0ff;
      font-size: 24px;
    }

    .user-info p {
      margin: 5px 0 0;
      font-size: 14px;
      opacity: 0.8;
    }

   

    footer.footer {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      padding: 20px;
      background: rgba(0, 0, 0, 0.7);
      text-align: center;
      color: #fff;
      font-size: 13px;
      border-top: 1px solid #0ff;
      z-index: 3;
      backdrop-filter: blur(5px);
    }

    @media (max-width: 768px) {
      .menu-item {
        width: 100px;
        height: 100px;
        font-size: 12px;
      }

      .menu-item img {
        width: 30px;
        height: 30px;
      }

      .user-info h3 {
        font-size: 20px;
      }
    }

    @media (max-width: 480px) {
      
      .menu-item {
        width: 80px;
        height: 100px;
        font-size: 15px;
      }

      .menu-item img {
        width: 40px;
        height: 35px;
      }

      .user-info h3 {
        font-size: 20px;
      }
    }
  </style>
</head>
<body>

  <!-- USER INFO (Will be filled from JS/API) -->
   <div class="user-info">
    <div class="user-profile">
      <img id="avatar" src="./img/Avatar.jpg" alt="Avatar" class="avatar">
      <div>
        <h3 id="name">Yuklanmoqda...</h3>
        <p id="level">--</p> <!-- Qo‘shildi -->
        <p id="xp">--</p>
      </div>
    </div>
    <div>
      <p id="rank">--</p>
      <p id="coins">Tanga: --</p>
    </div>
  </div>

  <main>
    
 </main>

  <footer class="footer">
    REKLAMA
  </footer>

  <!-- FETCH USER DATA FROM API -->
  <script>
   const tg = window.Telegram.WebApp;
    tg.expand();


    const userId = tg.initDataUnsafe?.user?.id;
    const ADMIN_IDS = ['7935500609']; // Admin chat ID lar ro‘yxati (o‘zgartiring)

    if (!userId) {
      document.getElementById('name').textContent = 'Telegram ID topilmadi!';
      document.getElementById('avatar').src = './img/default.jpg';
      showNotification('❌ Telegram ID topilmadi!');
      renderMenu(false); 
    } else {
      fetch(`/api/user?telegram_id=${userId}`)
        .then(res => {
          if (!res.ok) throw new Error("Foydalanuvchi topilmadi");
          return res.json();
        })
        .then(data => {
          document.getElementById('name').textContent = data.name || 'Nomaʼlum';
          document.getElementById('level').textContent = `Level: ${data.level || 1}`;
          document.getElementById('xp').textContent = `XP: ${data.xp || 0}`;
          document.getElementById('rank').textContent = `Rank: ${data.rank || 1} | Score: ${data.score || 0}`;
          document.getElementById('coins').textContent = `Tanga: ${data.coins?.toLocaleString() || 0}`;
          document.getElementById('avatar').src = data.avatar?.trim() ? data.avatar : './img/default.jpg';

          const isAdmin = ADMIN_IDS.includes(userId) || data.isAdmin; 
          renderMenu(isAdmin);
        })
        .catch(err => {
          console.error(err);
          document.getElementById('name').textContent = 'Xatolik!';
          showNotification(`❌ Xatolik: ${err.message}`);
          renderMenu(false); 
        });
    }
    </script>

</body>
</html>
